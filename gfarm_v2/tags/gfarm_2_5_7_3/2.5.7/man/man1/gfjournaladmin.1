.\" This manpage has been automatically generated by docbook2man 
.\" from a DocBook document.  This tool can be found at:
.\" <http://shell.ipoline.com/~elmert/comp/docbook2X/> 
.\" Please send any bug reports, improvements, comments, patches, 
.\" etc. to Steve Cheng <steve@ggi-project.org>.
.TH "GFJOURNALADMIN" "1" "02 July 2012" "Gfarm" ""

.SH NAME
gfjournaladmin \- erase a particular record in a journal file
.SH SYNOPSIS

\fBgfjournaladmin\fR [ \fB\fIoptions\fB\fR ] \fB\fIjournal-file\fB\fR \fB\fIsequence-number\fB\fR

.SH "DESCRIPTION"
.PP
\fBgfjournaladmin\fR erases a record with 
\fIsequence-number\fR in a journal file.
Since the record is replaced by A NOP (no operation) record with the
same length, other records in the journal file are not moved or modified.
.PP
When gfmd detects a conflict of metadata, it reports a log message like
as the following and aborts immediately.

.nf
	db_journal_store_thread : seqnum=938 ope=FILECOPY_ADD : \\
	    already exists
.fi
.PP
Such a conflict should not happen, but once it has been caused by a bug
of gfmd, restarting gfmd never succeeds.
Since gfmd applies journal data at boot time, it finds the conflict
and aborts again.
\fBgfjournaladmin\fR command is used for getting out from
the situation.  The log message shown above suggests a record with the 
sequence number 938 causes a conflict.
You can delete the record by executing:

.nf
	gfjournaladmin /var/gfarm-metadata/journal/0000000000.gmj 938
.fi
.PP
Note that \fBgfjournaladmin\fR cannot erase a journal
record of BEGIN (operation ID 1) or END (operation ID 2).
.SH "OPTIONS"
.TP
\fB-h\fR
Displays a list of command options.
.TP
\fB-?\fR
Equivalent to \fB-h\fR\&.
.TP
\fB-n\fR
Read a journal file, but do not write actually.
.TP
\fB-v\fR
Prints verbose messages.
