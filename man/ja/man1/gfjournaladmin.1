.\" This manpage has been automatically generated by docbook2man 
.\" from a DocBook document.  This tool can be found at:
.\" <http://shell.ipoline.com/~elmert/comp/docbook2X/> 
.\" Please send any bug reports, improvements, comments, patches, 
.\" etc. to Steve Cheng <steve@ggi-project.org>.
.TH "GFJOURNALADMIN" "1" "28 June 2012" "Gfarm" ""

.SH NAME
gfjournaladmin \- ジャーナルファイルの特定レコードを消去する。
.SH SYNOPSIS

\fBgfjournaladmin\fR [ \fB\fIオプション\fB\fR ] \fB\fIジャーナルファイル\fB\fR \fB\fIシーケンス番号\fB\fR

.SH "DESCRIPTION"
.PP
\fBgfjournaladmin\fR は、ジャーナルファイルの中から、
シーケンス番号 \fIsequence-number\fR を持った
レコードを消去します。
レコードは、同じ長さの NOP (no operation) レコードで置き換えられるため、
ジャーナルファイル内の他のレコードが移動したり、内容が変更されたりする
ことはありません。
.PP
gfmd はメタデータの不整合を検知すると、以下のようなログメッセージを出力
し、ただちに終了します。

.nf
	db_journal_store_thread : seqnum=938 ope=FILECOPY_ADD : \\
	    already exists
.fi
.PP
このような不整合は発生してはならないものではありますが、gfmd のバグに
よって一旦生じてしまうと、gfmd を再起動できなくなります。
起動時に gfmd はジャーナルデータの適用を行うため、再び不整合を検知して、
終了してしまいます。
\fBgfjournaladmin\fR コマンドは、このような状況から抜け出す
ために使用します。
上記のログメッセージでは、シーケンス番号 938 のレコードによって不整合が
起きていることが示されています。
このレコードを消すには、次のようにコマンドを実行します。

.nf
	gfjournaladmin /var/gfarm-metadata/journal/0000000000.gmj 938
.fi
.PP
BEGIN (オペレーションID 1) および END (オペレーションID 2) の
ジャーナルレコードは消すことができないので、注意して下さい。
.SH "OPTIONS"
.TP
\fB-h\fR
引数オプションを表示します。
.TP
\fB-?\fR
\fB-h\fR と同じです。
.TP
\fB-n\fR
ジャーナルファイルは読み込みますが、実際に書き出す処理は行いません。　
.TP
\fB-v\fR
冗長な表示を行います。
