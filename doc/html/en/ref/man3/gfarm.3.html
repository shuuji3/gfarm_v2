<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN""http://www.w3.org/TR/html4/loose.dtd">
<HTML
><HEAD
><TITLE
>gfarm</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.79"></HEAD
><BODY
CLASS="REFENTRY"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><H1
><A
NAME="GFARM.3"
></A
>gfarm</H1
><DIV
CLASS="REFNAMEDIV"
><A
NAME="NAME"
></A
><H2
>Name</H2
>gfarm&nbsp;--&nbsp;Gfarm file system API library</DIV
><DIV
CLASS="REFSYNOPSISDIV"
><A
NAME="SYNOPSIS"
></A
><H2
>Synopsis</H2
><PRE
CLASS="SYNOPSIS"
>#include &lt;gfarm/gfarm.h&gt;&#13;</PRE
></DIV
><DIV
CLASS="REFSECT1"
><A
NAME="DESCRIPTION"
></A
><H2
>DESCRIPTION</H2
><P
>The Gfarm library provides an interface layer to
the Gfarm file system.  This manual gives an overview of the
library.  For details, refer to a manual page of each function.</P
><DIV
CLASS="REFSECT2"
><A
NAME="AEN16"
></A
><H3
>Initialize / Finalize</H3
><P
><SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfarm_initialize</SPAN
>(3)</SPAN
> function is used for the initilization of the Gfarm
library, and
<SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfarm_terminate</SPAN
>(3)</SPAN
> function is used for the termination of the library.</P
></DIV
><DIV
CLASS="REFSECT2"
><A
NAME="AEN25"
></A
><H3
>File input/output operations</H3
><P
>To open an existing file as a stream,
<SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_pio_open</SPAN
>(3)</SPAN
> function is used.
To create an file and open the file as a stream,
<SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_pio_create</SPAN
>(3)</SPAN
> function is used.
<SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_pio_close</SPAN
>(3)</SPAN
> function is used to close such streams.</P
><P
><SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_pio_error</SPAN
>(3)</SPAN
> function is used to see whether an error happens or not
about a stream.
<SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_pio_eof</SPAN
>(3)</SPAN
> function is used to see whether a stream,
which is opened for read, already reaches end-of-file or not.
<SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_pio_seek</SPAN
>(3)</SPAN
> function changes the current position of the stream.</P
><P
><SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_pio_getc</SPAN
>(3)</SPAN
> function reads a character from a stream, and
<SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_pio_ungetc</SPAN
>(3)</SPAN
> function puts back a character to a stream.
<SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_pio_getline</SPAN
>(3)</SPAN
> function,
<SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_pio_gets</SPAN
>(3)</SPAN
> function, and
<SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_pio_readline</SPAN
>(3)</SPAN
> function read one line from a stream, and
<SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_pio_readdelim</SPAN
>(3)</SPAN
> function reads from stream until delimiter character,
specified by the function argument, appears.
<SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_pio_read</SPAN
>(3)</SPAN
> function reads specified bytes from a stream.</P
><P
><SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_pio_putc</SPAN
>(3)</SPAN
> function writes one character to a stream, and
<SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_pio_putline</SPAN
>(3)</SPAN
> function and
<SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_pio_puts</SPAN
>(3)</SPAN
> function write one line to a stream.
<SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_pio_write</SPAN
>(3)</SPAN
> function writes specified bytes to a stream.
<SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_pio_flush</SPAN
>(3)</SPAN
> function,
<SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_pio_sync</SPAN
>(3)</SPAN
> function and
<SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_pio_datasync</SPAN
>(3)</SPAN
> function moves buffered data to a storage device.

<SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_pio_truncate</SPAN
>(3)</SPAN
> function truncates a file.</P
></DIV
><DIV
CLASS="REFSECT2"
><A
NAME="AEN94"
></A
><H3
>Directory access</H3
><P
><SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_opendir</SPAN
>(3)</SPAN
> function opens a directory, and
<SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_readdir</SPAN
>(3)</SPAN
> function retrieves entries of the directory.
<SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_closedir</SPAN
>(3)</SPAN
> function closes the directory.</P
><P
>A gfs_glob_t data, which is initialized by
<SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_glob_init</SPAN
>(3)</SPAN
> function,
can be passed to
<SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_glob</SPAN
>(3)</SPAN
> function, and the gfs_glob function returns
list of matched file/directory names in the gfs_glob_t.
The gfs_glob_t must be released by 
<SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_glob_free</SPAN
>(3)</SPAN
> function.
<SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_glob_add</SPAN
>(3)</SPAN
> function is used add an entry to gfs_glob_t.</P
></DIV
><DIV
CLASS="REFSECT2"
><A
NAME="AEN119"
></A
><H3
>File / Directory manipulation</H3
><P
><SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_chmod</SPAN
>(3)</SPAN
> function changes the mode of a file, and
<SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_chown</SPAN
>(3)</SPAN
> function changes the owner of a file, and
<SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_utimes</SPAN
>(3)</SPAN
> function changes file's modification time and access time.</P
><P
><SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_mkdir</SPAN
>(3)</SPAN
> function creates a directory, and
<SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_rmdir</SPAN
>(3)</SPAN
> function removes a directory.
<SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_unlink</SPAN
>(3)</SPAN
> function removes a file, and
<SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_rename</SPAN
>(3)</SPAN
> function renames a file or a directory.</P
><P
><SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_stat</SPAN
>(3)</SPAN
> function returns information like size, modified/access
time, etc.
The struct gfs_stat returned by gfs_stat function must be released by
<SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_stat_free</SPAN
>(3)</SPAN
> function.</P
></DIV
><DIV
CLASS="REFSECT2"
><A
NAME="AEN151"
></A
><H3
>ACL (Access Control List) OPERATIONS</H3
><P
><SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_acl_init</SPAN
>(3)</SPAN
> function is used for the initilization of an ACL
structure (gfarm_acl_t), and
<SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_acl_free</SPAN
>(3)</SPAN
> function is used to release the ACL structure.
<SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_acl_dup</SPAN
>(3)</SPAN
> function duplicates an ACL structure.</P
><P
><SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_acl_create_entry</SPAN
>(3)</SPAN
> function creates an ACL entry (gfarm_acl_entry_t) in
an ACL structure, and
<SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_acl_get_entry</SPAN
>(3)</SPAN
> function gets an ACL entry from the ACL structure, and
<SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_acl_delete_entry</SPAN
>(3)</SPAN
> function removes an ACL entry from the ACL structure.</P
><P
><SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_acl_valid</SPAN
>(3)</SPAN
> function checks an ACL structure for validity.
gfs_acl_check(3) function can check more for
validity.</P
><P
><SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_acl_calc_mask</SPAN
>(3)</SPAN
> function calculates and sets an ACL permissions of
a GFARM_ACL_MASK type entry in an ACL structure.</P
><P
><SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_acl_get_tag_type</SPAN
>(3)</SPAN
> function gets an ACL tag (gfarm_acl_tag_t) (type of
ACL entry) from an ACL entry.
<SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_acl_set_tag_type</SPAN
>(3)</SPAN
> function sets an ACL tag of an ACL entry.</P
><P
><SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_acl_get_permset</SPAN
>(3)</SPAN
> function gets an ACL permission-set
(gfarm_acl_permset_t) from an ACL entry.
<SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_acl_set_permset</SPAN
>(3)</SPAN
> function an ACL permission-set of an ACL entry.</P
><P
><SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_acl_add_perm</SPAN
>(3)</SPAN
> function adds an ACL permission (gfarm_acl_perm_t) to
an ACL permission-set.
<SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_acl_clear_perms</SPAN
>(3)</SPAN
> clears all ACL permissions from an ACL permission-set.
<SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_acl_delete_perm</SPAN
>(3)</SPAN
> function deletes a permission from an ACL permission-set.</P
><P
><SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_acl_get_qualifier</SPAN
>(3)</SPAN
> function gets a username/groupname from an ACL entry.
GFARM_ACL_USER/GFARM_ACL_GROUP tag entries have a username/groupname.
<SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_acl_set_qualifier</SPAN
>(3)</SPAN
> function sets a username/groupname of an ACL entry.</P
><P
><SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_acl_delete_def_file</SPAN
>(3)</SPAN
> function deletes a Default ACL from a file or directory.
<SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_acl_get_file</SPAN
>(3)</SPAN
> function gets an ACL structure of a file or directory.
<SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_acl_set_file</SPAN
>(3)</SPAN
> function replaces an ACL structure of a file or directory.
Before using this function, the ACL structure must be sorted by
gfs_acl_sort(3) function.</P
><P
><SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_acl_to_text</SPAN
>(3)</SPAN
> function converts an ACL structure to an ACL text.
gfs_acl_to_any_text(3) function is more
functional than this function.
<SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_acl_from_text</SPAN
>(3)</SPAN
> function creates an ACL structure from an ACL text.</P
><P
><SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_acl_get_perm</SPAN
>(3)</SPAN
> function tests for an ACL permission in an ACL
permission set.</P
><P
><SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_acl_check</SPAN
>(3)</SPAN
> function checks an ACL structure for validity.
And, this function can get the place of the error and the ACL error code.
This function is more functional than
gfs_acl_valid(3) function.
<SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_acl_error</SPAN
>(3)</SPAN
> function converts an ACL error code of
gfs_acl_check(3) function to a text message.</P
><P
><SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_acl_entries</SPAN
>(3)</SPAN
> function returns the number of entries in an ACL structure.</P
><P
><SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_acl_equiv_mode</SPAN
>(3)</SPAN
> checks for an equivalent ACL structure.  An equivalent
ACL structure has only base ACL entries of tag types
(GFARM_ACL_USER_OBJ, GFARM_ACL_GROUP_OBJ, GFARM_ACL_OTHER).  And, this
function can create a file permission bits (gfarm_mode_t) from base
ACL entries.</P
><P
><SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_acl_cmp</SPAN
>(3)</SPAN
> function compares two ACL structures.</P
><P
><SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_acl_from_mode</SPAN
>(3)</SPAN
> function creates an ACL structure from file permission
bits (gfarm_mode_t).</P
><P
><SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_acl_to_any_text</SPAN
>(3)</SPAN
> function converts an ACL structure to an ACL text.  This
function has some options for output format.  This function is more
functional than gfs_acl_to_text(3) function.</P
><P
><SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_acl_to_xattr_value</SPAN
>(3)</SPAN
> converts an ACL structure to ACL binary data for
Extended Attribute value.  Before using this function, the ACL
structure must be sorted by gfs_acl_sort(3)
function.
<SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_acl_from_xattr_value</SPAN
>(3)</SPAN
> converts ACL binary data for Extended Attribute value
to an ACL structure.</P
><P
><SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_acl_sort</SPAN
>(3)</SPAN
> function sorts ACL entries of an ACL structure in ACL
validity order.</P
><P
><SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfs_acl_from_text_with_default</SPAN
>(3)</SPAN
> function creates two ACL structures (Access ACL and
Default ACL) from an ACL text which includes "default:" prefix.</P
></DIV
><DIV
CLASS="REFSECT2"
><A
NAME="AEN282"
></A
><H3
>Error handling</H3
><P
>Most Gfarm API returns the Gfarm error code in gfarm_error_t.
<SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfarm_error_string</SPAN
>(3)</SPAN
> function returns a string describing the Gfarm error code.
<SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfarm_errno_to_error</SPAN
>(3)</SPAN
> function translates the error number (errno) to the Gfarm
error code.
<SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfarm_error_to_errno</SPAN
>(3)</SPAN
> function translates the Gfarm error code to the error number.</P
></DIV
><DIV
CLASS="REFSECT2"
><A
NAME="AEN294"
></A
><H3
>String Array manipulation utilities</H3
><P
>A gfarm_stringlist type variable represents an array of strings,
and this type is initialized by
<SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfarm_stringlist_init</SPAN
>(3)</SPAN
> function.
<SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfarm_stringlist_add</SPAN
>(3)</SPAN
> function is used to add a string to a gfarm_stringlist.
<SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfarm_stringlist_cat</SPAN
>(3)</SPAN
> function is used to add strings to a gfarm_stringlist.
<SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfarm_stringlist_free</SPAN
>(3)</SPAN
> function releases gfarm_stringlist.
<SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfarm_stringlist_elem</SPAN
>(3)</SPAN
> function or
GFARM_STRINGLIST_ELEM() macro
can be used to access each string of an array.
<SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfarm_stringlist_length</SPAN
>(3)</SPAN
> function can be used to see number of strings in an array.</P
><P
><SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfarm_strings_free_deeply</SPAN
>(3)</SPAN
> function releases a string array and each element of the
array by calling standard library function free().</P
></DIV
><DIV
CLASS="REFSECT2"
><A
NAME="AEN319"
></A
><H3
>String Array manipulation macros</H3
><P
></P
><DIV
CLASS="VARIABLELIST"
><DL
><DT
>GFARM_STRINGLIST_ELEM(list, i)</DT
><DD
><P
>represents <CODE
CLASS="PARAMETER"
>i</CODE
>-th element of
the <CODE
CLASS="PARAMETER"
>list</CODE
> argument which type is gfarm_stringlist.
This macro can be used as a L-value.
If this macro is used as a value, it returns same result with
<SPAN
CLASS="CITEREFENTRY"
><SPAN
CLASS="REFENTRYTITLE"
>gfarm_stringlist_elem</SPAN
>(3)</SPAN
> function.</P
></DD
><DT
>GFARM_STRINGLIST_STRARRAY(list)</DT
><DD
><P
>returns pointer to first element of the <CODE
CLASS="PARAMETER"
>list</CODE
> argument
which type is gfarm_stringlist.
The type of the return value is a pointer to pointer to a character.</P
></DD
></DL
></DIV
></DIV
></DIV
></BODY
></HTML
>